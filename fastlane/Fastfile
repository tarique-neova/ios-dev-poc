default_platform :ios
platform :ios do

  before_all do
    setup_circle_ci
  end

  lane :use_cert do

      app_store_connect_api_key(
        key_id: "WXYFK8CF5D",
        issuer_id: "6701bcf4-21c5-4e25-9fd7-76af487a8e20",
        key_content: "-----BEGIN PRIVATE KEY-----\nMIGTAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBHkwdwIBAQQgz8S6G+oCbY+DlpDO44h91CyqPHc1f1hDIvO90XyVyi+gCgYIKoZIzj0DAQehRANCAATRh6sKuK3JunOpDqvb1xdkwZ3kbmiAueV/XaTNdZ/JNlbOW33ikt7yrA9jCDoukR0mqh1PisbBdCXuqJmmAkcC\n-----END PRIVATE KEY-----"
      )
      match(
        type: "development",
        readonly: false,
        force_for_new_devices: false,
        app_identifier: "com.neovasolutions.ios-dev-poc",
        git_url: "https://github.com/tarique-neova/ios-dev-poc.git",
      )

      match(
        type: "appstore",
        readonly: false,
        force_for_new_devices: false,
        app_identifier: "com.neovasolutions.ios-dev-poc",
        git_url: "https://github.com/tarique-neova/ios-dev-poc.git",
      )
  
    # Add other actions related to your lane if needed
  end

  desc "Update Signing Setting"
    lane :update_sign_set do

        update_code_signing_settings(
          use_automatic_signing: true,
          # targets: ["ios-dev-poc"], # specify which targets to update code signing settings for
          # code_sign_identity: "Apple Development", # replace with name of code signing identity if different
          # bundle_identifier: "com.neovasolutions.ios-dev-poc",
          # profile_name: "match Development com.neovasolutions.ios-dev-poc",
          # build_configurations: ["Debug"], # only toggle code signing settings for Release configurations
          # path: "ios-dev-poc.xcodeproj",
          # team_id: "2ZBVR8AP3W"
          
        )

    end


  # lane :upload_release do

  #   increment_build_number(
  #     build_number: "$CIRCLE_BUILD_NUM"
  #   )

  # api_key = app_store_connect_api_key(
  #   key_id: "WXYFK8CF5D",
  #   issuer_id: "6701bcf4-21c5-4e25-9fd7-76af487a8e20",
  #   key_content: "-----BEGIN PRIVATE KEY-----\nMIGTAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBHkwdwIBAQQgz8S6G+oCbY+DlpDO44h91CyqPHc1f1hDIvO90XyVyi+gCgYIKoZIzj0DAQehRANCAATRh6sKuK3JunOpDqvb1xdkwZ3kbmiAueV/XaTNdZ/JNlbOW33ikt7yrA9jCDoukR0mqh1PisbBdCXuqJmmAkcC\n-----END PRIVATE KEY-----"
  # )

  #   # Build your iOS app
  #   gym(scheme: "ios-dev-poc",
  #       # skip_profile_detection: true,
  #     )
  #   # Upload the app to App Store Connect
  #   pilot(api_key: api_key)
  # end

  lane :release do

        produce(
          username: 'cloudsupport@neovasolutions.com',
          app_identifier: 'com.neovasolutions.ios-dev-poc',
          app_name: 'neovapoc',
          language: 'English',
          app_version: '1.0',
          sku: '123',        
          team_id: '2ZBVR8AP3W', # only necessary when in multiple teams


          enable_services: {
          access_wifi: "on",                        # Valid values: "on", "off"
          app_attest: "on",                         # Valid values: "on", "off"
          app_group: "on",                          # Valid values: "on", "off"
          apple_pay: "on",                          # Valid values: "on", "off"
          associated_domains: "on",                 # Valid values: "on", "off"
          auto_fill_credential: "on",               # Valid values: "on", "off"
          car_play_audio_app: "on",                 # Valid values: "on", "off"
          car_play_messaging_app: "on",             # Valid values: "on", "off"
          car_play_navigation_app: "on",            # Valid values: "on", "off"
          car_play_voip_calling_app: "on",          # Valid values: "on", "off"
          class_kit: "on",                          # Valid values: "on", "off"
          icloud: "xcode15_compatible",              # Valid values: "xcode5_compatible", "xcode6_compatible", "off"
          critical_alerts: "on",                    # Valid values: "on", "off"
          custom_network_protocol: "on",            # Valid values: "on", "off"
          data_protection: "complete",              # Valid values: "complete", "unlessopen", "untilfirstauth", "off"
          extended_virtual_address_space: "on",     # Valid values: "on", "off"
          file_provider_testing_mode: "on",         # Valid values: "on", "off"
          fonts: "on",                              # Valid values: "on", "off"
          game_center: "ios",                       # Valid values: "ios", "macos", off"
          health_kit: "on",                         # Valid values: "on", "off"
          hls_interstitial_preview: "on",           # Valid values: "on", "off"
          home_kit: "on",                           # Valid values: "on", "off"
          hotspot: "on",                            # Valid values: "on", "off"
          hotspot_helper: "on",                     # Valid values: "on", "off"
          in_app_purchase: "on",                    # Valid values: "on", "off"
          inter_app_audio: "on",                    # Valid values: "on", "off"
          low_latency_hls: "on",                    # Valid values: "on", "off"
          managed_associated_domains: "on",         # Valid values: "on", "off"
          maps: "on",                               # Valid values: "on", "off"
          multipath: "on",                          # Valid values: "on", "off"
          network_extension: "on",                  # Valid values: "on", "off"
          nfc_tag_reading: "on",                    # Valid values: "on", "off"
          passbook: "on",                           # Valid values: "on", "off" (deprecated)
          personal_vpn: "on",                       # Valid values: "on", "off"
          push_notification: "on",                  # Valid values: "on", "off"
          sign_in_with_apple: "on",                 # Valid values: "on", "off"
          siri_kit: "on",                           # Valid values: "on", "off"
          system_extension: "on",                   # Valid values: "on", "off"
          user_management: "on",                    # Valid values: "on", "off"
          vpn_configuration: "on",                  # Valid values: "on", "off" (deprecated)
          wallet: "on",                             # Valid values: "on", "off"
          wireless_accessory: "on",                 # Valid values: "on", "off"
          driver_kit: "on",                         # Valid values: "on", "off"
          driver_kit_endpoint_security: "on",       # Valid values: "on", "off"
          driver_kit_family_hid_device: "on",       # Valid values: "on", "off"
          driver_kit_family_networking: "on",       # Valid values: "on", "off"
          driver_kit_family_serial: "on",           # Valid values: "on", "off"
          driver_kit_hid_event_service: "on",       # Valid values: "on", "off"
          driver_kit_transport_hid: "on",           # Valid values: "on", "off"
          multitasking_camera_access: "on",         # Valid values: "on", "off"
          sf_universal_link_api: "on",              # Valid values: "on", "off"
          vp9_decoder: "on",                        # Valid values: "on", "off"
          music_kit: "on",                          # Valid values: "on", "off"
          shazam_kit: "on",                         # Valid values: "on", "off"
          communication_notifications: "on",        # Valid values: "on", "off"
          group_activities: "on",                   # Valid values: "on", "off"
          health_kit_estimate_recalibration: "on",  # Valid values: "on", "off"
          time_sensitive_notifications: "on",       # Valid values: "on", "off"
        }
      ) 
  end
end
